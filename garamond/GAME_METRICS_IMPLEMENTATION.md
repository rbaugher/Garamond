// GAME METRICS COLLECTION IMPLEMENTATION
// ======================================

## Overview
Game metrics are now automatically collected when a Tic Tac Toe game ends (win, loss, or tie) and sent to MongoDB.

## Files Created/Modified

### 1. NEW: api/gameMetrics.js
- Backend API endpoint for receiving and storing game metrics
- Stores metrics in the "Game Metrics" collection in the Garamond database
- Validates required fields (playerName, gameType, outcome)
- Records timestamp automatically

### 2. NEW: src/games/components/functions/gameMetricsCollector.js
- Client-side utility functions for handling game metrics
- `recordGameMetrics()` - Sends metrics to backend API
- `getWinningCondition()` - Determines winning condition from winning tiles
  - Returns: 'row_0', 'row_1', 'row_2', 'column_0', 'column_1', 'column_2', 
             'diagonal_main', 'diagonal_anti', or 'tie'

### 3. MODIFIED: src/games/components/Board.jsx
- Added import for gameMetricsCollector functions
- Added gameStartTimeRef to track when game started
- Updated game end detection to call recordGameMetrics()
- Updated handleReset to reset game start time for new games

## Data Collected

Each game record contains:
```javascript
{
  playerName: string,           // "Player" or "Player X" in multiplayer
  opponentName: string,         // "Computer" in singleplayer or "Player O" in multiplayer
  gameType: string,             // "Tic Tac Toe Squared"
  outcome: string,              // "Win", "Loss", or "Tie" (from player's perspective)
  difficulty: number | null,    // 0 (Easy), 1 (Medium), 2 (Hard), or null for multiplayer
  winningCondition: string,     // e.g., "row_0", "diagonal_main", "tie"
  moveList: array,              // All moves made during the game
  gameDuration: number,         // Duration in seconds
  timestamp: string,            // ISO timestamp
  createdAt: Date               // Auto-generated by server
}
```

## How It Works

1. **Game Start**: gameStartTimeRef is set to Date.now() when Board component mounts or resets
2. **Game Play**: All moves are tracked in the moveList state
3. **Game End**: 
   - checkWinner() detects a winner → winningCondition determined → metrics sent
   - noPossibleMove() detects a tie → metrics sent with winningCondition: "tie"
4. **Metrics Sent**: recordGameMetrics() sends data to /api/gameMetrics
5. **Stored**: Data inserted into "Game Metrics" collection with _id and createdAt

## Error Handling
- If metrics recording fails, error is logged to console but doesn't interrupt game
- User won't see any disruption if API call fails

## Example Database Document
```javascript
{
  _id: ObjectId("..."),
  playerName: "Player",
  opponentName: "Computer",
  gameType: "Tic Tac Toe Squared",
  outcome: "Win",
  difficulty: 1,  // Medium difficulty
  winningCondition: "row_0",
  moveList: [
    { index: 4, value: 3, player: "X" },
    { index: 0, value: 1, player: "O" },
    ...
  ],
  gameDuration: 45,  // 45 seconds
  timestamp: "2025-11-18T20:30:45.123Z",
  createdAt: ISODate("2025-11-18T20:30:45.123Z")
}
```

## Testing the Implementation

1. Play a game until completion (win or tie)
2. Check MongoDB "Game Metrics" collection
3. Verify data was recorded correctly
4. Play multiple games with different difficulties and game modes

## Future Enhancements
- Player authentication (store actual user ID instead of "Player")
- Real player names in multiplayer mode
- Game statistics dashboard to view metrics
- Analytics on win rates by difficulty
- Leaderboard integration with recorded metrics
